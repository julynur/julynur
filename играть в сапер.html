
<!DOCTYPE html>
<html lang="en">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<head>
	<meta charset="utf-8" />
	<title>Сапёр онлайн на JavaScript</title>
	<link rel="stylesheet" href="images/minesweeper.min.css" />
	<script src="images/jquery-1.8.3.min.js"></script>
	<script src="images/minesweeper.min.js"></script>




<script>
	if (window.top != window.self) {
		window.top.location = 'images/d326c07d2188da9e.gif';
	}

	$(function() {
		var gameType = 'expert';
		var zoom = '100';
		var position = 'center';
		var isNightMode = false;
		var hashParts, i;
		var minesweeper;

		if (!!location.hash && location.hash.length > 1) {
			hashParts = location.hash.substring(1).split('-');

			for (i = 0; i < hashParts.length; i++) {
				switch (hashParts[i]) {
					case 'beginner':     gameType = 'beginner';     break;
					case 'intermediate': gameType = 'intermediate'; break;
					case '150':          zoom = '150';              break;
					case '200':          zoom = '200';              break;
					case 'left':         position = 'left';         break;
					case 'night':        isNightMode = true;        break;
				}
			}
		}

		$('#' + gameType).attr('checked', true);
		$('#zoom' + zoom).attr('checked', true);
		$('#position-' + position).attr('checked', true);
		$('#nightMode').attr('checked', isNightMode);

		document.getElementById('game-container').className = 'z' + zoom;
		setPosition(position);

		if (isNightMode) {
			toggleNightMode(isNightMode);
		}

		minesweeper = new Minesweeper([
			[ 3, 24, 65],
			[ 2, 20, 60],
			[ 1, 12, 55],
			[ 1, 10, 45]
		], readOptions);

		minesweeper.onWin = function(gameTypeId, time) {
			var mode;
			switch (gameTypeId) {
				case 1: mode = 'Новичок'; break;
				case 2: mode = 'Бывалый'; break;
				case 3: mode = 'Эксперт'; break;
				default: return;
			}

		};

		minesweeper.onNewHighScore = function(intervalTypeId) {
			$('#scores-panes').load('scores-panes0d3e.html?interval=' + intervalTypeId + '&r=' + Math.random());
			if (intervalTypeId === 1) $('#daily-link').click();
			if (intervalTypeId === 2) $('#weekly-link').click();
			if (intervalTypeId === 3) $('#monthly-link').click();
			if (intervalTypeId === 4) $('#alltime-link').click();
		};

		minesweeper.newGame();
		setHash();

		$("#options-link, #options-close").click(function() {
			$("#display").hide();
			$("#controls").hide();
			$("#options").toggle();
				
		});

		$("#options-form").submit(function(e) {
			$("#options").hide();
			minesweeper.newGame();
			setHash();
			e.preventDefault()
		});

		$("#display-link, #display-close").click(function() {
			$("#options").hide();
			$("#controls").hide();
			$("#display").toggle();
				
		});

		$('input[name="zoom"]').change(function() {
			var zoom = parseFloat($(this).val());
			minesweeper.resize(zoom);
			setHash();
		});

		$('input[name="position"]').change(function() {
			setPosition($(this).val());
			setHash();
		});

		$('input[name="nightMode"]').change(function() {
			var isNightMode = $(this).is(':checked');
			toggleNightMode(isNightMode);
			setHash();
		});

		$("#controls-link, #controls-close").click(function() {
			$("#options").hide();
			$("#display").hide();
			$("#controls").toggle();
		});

		$(document).keydown(function(e) {
			if (e.keyCode == 27) { //escape
				$("#options, #display, #controls").hide();
			}
		});

		$(".scores-tab").click(function() {
			var id = this.id;
			$(".scores-tab-selected").removeClass("scores-tab-selected");
			$(this).addClass("scores-tab-selected");
			$(".scores-pane").hide();
			$("#" + id.substring(0, id.length - 5)).show();
		});

		$('#share-close').click(function() {
			$('#share').fadeOut();
		});



		function setPosition(position) {
			if (position == 'left') {
				$('.outer-container').css('text-align', 'left' );
				$('body').css('margin-left', '20px');
			}
			else if (position == 'center') {
				$('.outer-container').css('text-align', 'center');
				$('body').css('margin-left', '0px');
			}
		}

		function toggleNightMode(isOn) {
			$('body').toggleClass('night-mode', isOn);
		}

		function readOptions() {
			var gameTypeId;
			var numRows;
			var numCols;
			var numMines;
			var zoom;

			if ($("#beginner").attr("checked")) {
				gameTypeId = 1;
				numRows = 9;
				numCols = 9;
				numMines = 10;
			}
			else if ($("#intermediate").attr("checked")) {
				gameTypeId = 2;
				numRows = 16;
				numCols = 16;
				numMines = 40;
			}
			else if ($("#expert").attr("checked")) {
				gameTypeId = 3;
				numRows = 16;
				numCols = 30;
				numMines = 99;
			}
			else if ($("#custom").attr("checked")) {
				gameTypeId = 0;

				numRows = parseInt($("#custom_height").val(), 10);
				if (isNaN(numRows)) {
					numRows = 20;
				}
				numRows = Math.max(1, numRows);
				numRows = Math.min(999, numRows);
				$("#custom_height").val(numRows);

				numCols = parseInt($("#custom_width").val(), 10);
				if (isNaN(numCols)) {
					numCols = 30;
				}
				numCols = Math.max(8, numCols);
				numCols = Math.min(199, numCols);
				$("#custom_width").val(numCols);

				numMines = parseInt($("#custom_mines").val(), 10);
				if (isNaN(numMines)) {
					numMines = Math.round(numRows * numCols / 5);
				}
				numMines = Math.max(0, numMines);
				numMines = Math.min(numRows * numCols - 1, numMines);
				$("#custom_mines").val(numMines);
			}

			zoom = parseFloat($('input[name="zoom"]:checked').val());

			return {
				gameTypeId: gameTypeId,
				numRows: numRows,
				numCols: numCols,
				numMines: numMines,
				zoom: zoom
			};
		}

		function setHash() {
			var gameType = 'expert';
			var zoom = $('input[name="zoom"]:checked').val();
			var position = $('input[name="position"]:checked').val();
			var isNightMode = $('input[name="nightMode"]').is(':checked');
			var hashParts = [];

			if ($("#beginner").attr("checked")) {
				hashParts.push("beginner");
			}
			else if ($("#intermediate").attr("checked")) {
				hashParts.push("intermediate");
			}

			if (zoom != 1) {
				hashParts.push(zoom * 100);
			}

			if (position != "center") {
				hashParts.push(position);
			}

			if (isNightMode) {
				hashParts.push('night');
			}

			if (hashParts.length > 0) {
				location.hash = '#' + hashParts.join('-');
			}
			else {
				location.hash = '';
			}
		}
	});
	</script>

</head>

<body>
	
	<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%"><tr><td class="outer-container"><div class="inner-container" style="margin-left: auto; margin-right: auto;">

	
	<div id="center-column">
		<div id="game-container" class="z100">
			<span id="options-link" title="game options">Настройки</span> | <span id="display-link" title="size/position">Отображение</span> | <span id="controls-link" title="keyboard/mouse controls">Управление</span>
			<div id="game" oncontextmenu="return false;" ondrag="return false;" ondragstart="return false;"></div>

			<form id="options-form">
				<table cellspacing="0" cellpadding="2" id="options" class="dialog">
					<tr class="dialog-title">
						<td style="padding: 3px;">Игра</td>
						<td colspan="3" style="padding: 3px; text-align: right;">
							<span id="options-close" class="dialog-close" title="close this box">&times;</span>
						</td>
					</tr>
					<tr class="dialog-bar">
						<td></td>
						<td>Высота</td>
						<td>Ширина</td>
						<td>Мины</td>
					</tr>
					<tr>
						<td><label><input type="radio" name="field" id="beginner" /> <strong>Новичок</strong></label></td>
						<td>9</td>
						<td>9</td>
						<td>10</td>
					</tr>
					<tr>
						<td><label><input type="radio" name="field" id="intermediate" /> <strong>Бывалый</strong></label></td>
						<td>16</td>
						<td>16</td>
						<td>40</td>
					</tr>
					<tr>
						<td><label><input type="radio" name="field" checked="checked" id="expert" /> <strong>Эксперт</strong></label></td>
						<td>16</td>
						<td>30</td>
						<td>99</td>
					</tr>
					<tr>
						<td><label><input type="radio" name="field" id="custom" /> Особый</label></td>
						<td><input type="text" value="20" id="custom_height" class="dialog-text-input" onfocus="$('#custom').attr('checked', true);" /></td>
						<td><input type="text" value="30" id="custom_width" class="dialog-text-input" onfocus="$('#custom').attr('checked', true);" /></td>
						<td><input type="text" value="145" id="custom_mines" class="dialog-text-input" onfocus="$('#custom').attr('checked', true);" /></td>
					</tr>
					<tr class="dialog-bar">
						<td><input type="submit" value="Новая игра" class="dialogText" style="vertical-align: middle;" /></td>
						<td colspan="3">
							<label style="margin-bottom: 0;"><input type="checkbox" id="marks" /> Включить (?)</label>
						</td>
					</tr>
				</table>
			</form>

			<table cellspacing="0" cellpadding="2" id="display" class="dialog">
				<tr class="dialog-title">
					<td>Отображение</td>
					<td style="text-align: right;">
						<span id="display-close" class="dialog-close" title="close this box">&times;</span>
					</td>
				</tr>
				<tr>
					<td style="padding: 6px;"><strong>Увеличение</strong></td>
					<td style="padding: 6px;">
						<label><input type="radio" name="zoom" id="zoom100" value="1" checked="checked"/> 100%</label><br />
						<label><input type="radio" name="zoom" id="zoom150" value="1.5" /> 150%</label><br />
						<label><input type="radio" name="zoom" id="zoom200" value="2" /> 200%</label>
					</td>
				</tr>
				<tr>
					<td style="padding: 6px; border-top: 1px solid #AAA;"><strong>Позиция</strong></td>
					<td style="padding: 6px; border-top: 1px solid #AAA;">
						<label><input type="radio" name="position" id="position-center" value="center" /> По центру</label><br />
						<label><input type="radio" name="position" id="position-left" value="left" checked="checked" /> Слева</label>
					</td>
				</tr>
				<tr>
					<td style="padding: 6px; border-top: 1px solid #AAA;"><label for="nightMode"><strong>Ночной режим</strong></label></td>
					<td style="padding: 6px; border-top: 1px solid #AAA;">
						<input type="checkbox" name="nightMode" id="nightMode" />
					</td>
				</tr>
			</table>

			<table cellspacing="0" cellpadding="2" id="controls" class="dialog">
				<tr class="dialog-title">
					<td>Управление</td>
					<td style="text-align: right;">
						<span id="controls-close" class="dialog-close" title="close this box">&times;</span>
					</td>
				</tr>
				<tr>
					<td style="padding: 6px;"><strong>Мышкой</strong></td>
					<td style="padding: 6px;">
						<ul>
							<li><b>Левая кнопка</b>открывает ячейку.</li>
							<li><b>Правая кнопка</b> (или <b>Ctrl+click</b>) Ставит на клетке флаг.</li>
							<li><b>Колёсико</b> (или <b>левая+правая клавиши</b>) открывает соседние ячейки<br /> когда выставлены флажки.</li>
							<li>Нажмите <b>пробел</b>чтобы отметить ячейку флагом<br />или открыть все  соседние ячейки без флажков</li>
							<li>Нажмите <b>F2</b> чтобы начать новую игру.</li>
						</ul>
					</td>
				</tr>
				<tr>
					<td style="padding: 6px; border-top: 1px solid #AAA;"><strong>Для мобильных смартфонов</strong></td>
					<td style="padding: 6px; border-top: 1px solid #AAA;">
						<ul>
							<li><b>Нажатие</b> ставит на клетке флаг.</li>
							<li><b>Long-press</b> an empty square to flag it.</li>
							<li><b>Tap</b> a number to reveal its adjacent squares.</li>
						</ul>
					</td>
				</tr>
			</table>
		</div>

		

		<div id="share">
			<div id="share-close" title='dismiss "share" dialog'>&times;</div>
			Поздравления!
			
		</div>

		<style>
		
		.rainbow_text {
font-size:130%;
text-decoration:none;
animation-name: dscocolor;
animation-timing-function: linear;
animation-iteration-count: infinite;
animation-duration: 5s;
animation-direction: alternate;
-moz-animation-name: dscocolor;
-moz-animation-timing-function: linear;
-moz-animation-iteration-count: infinite;
-moz-animation-duration: 5s;
-moz-animation-direction: alternate;
-webkit-animation-name: dscocolor;
-webkit-animation-timing-function: linear;
-webkit-animation-iteration-count: infinite;
-webkit-animation-duration: 5s;
-webkit-animation-direction: alternate;
-o-animation-name: dscocolor;
-o-animation-timing-function: linear;
-o-animation-iteration-count: infinite;
-o-animation-duration: 5s;
-o-animation-direction: alternate;
-ms-animation-name: dscocolor;
-ms-animation-timing-function: linear;
-ms-animation-iteration-count: infinite;
-ms-animation-duration: 5s;
-ms-animation-direction: alternate;
}
@-moz-keyframes dscocolor {
0% { color: blue; }
20% { color: red; }
40% { color: green; }
60% { color: black; }
80% { color: indigo; }
100% { color: gold; }
}
@-webkit-keyframes dscocolor {
0% { color: blue; }
20% { color: red; }
40% { color: green; }
60% { color: black; }
80% { color: indigo; }
100% { color: gold; }
}
@-o-keyframes dscocolor {
0% { color: blue; }
20% { color: red; }
40% { color: green; }
60% { color: black; }
80% { color: indigo; }
100% { color: gold; }
}
@-ms-keyframes dscocolor {
0% { color: blue; }
20% { color: red; }
40% { color: green; }
60% { color: black; }
80% { color: indigo; }
100% { color: gold; }
}
@keyframes dscocolor {
0% { color: blue; }
20% { color: red; }
40% { color: green; }
60% { color: black; }
80% { color: indigo; }
100% { color: gold; }
}
.rainbow_text:hover {
font-size:140%;
}
		
		</style>
		
		                         
		
		

	</div></table>

</body>
</html>

